<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>IoT-Based Air Quality Monitoring System | Project Wiki</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- ===== STYLE (CSS) ===== -->
    <style>
        :root {
            --primary: #3366cc;
            --bg-light: #f6f6f6;
            --box-bg: #f8f9fa;
            --border: #a2a9b1;
        }

        body {
            font-family: "Georgia", serif;
            background-color: var(--bg-light);
            color: #202122;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1100px;
            /* wider for laptop */
            margin: auto;
            background: #ffffff;
            padding: 30px;
            box-shadow: 0 0 12px rgba(0, 0, 0, 0.12);
        }

        h1,
        h2 {
            border-bottom: 2px solid var(--border);
            padding-bottom: 6px;
        }

        p {
            text-align: justify;
            line-height: 1.7;
        }

        /* ===== FLEX SECTIONS ===== */
        .media-box {
            margin-top: 25px;
            padding: 20px;
            border: 1px solid var(--border);
            background: var(--box-bg);
            border-radius: 6px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .media-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.15);
        }

        /* ===== SUMMARY ===== */
        .summary-box {
            max-height: 340px;
            overflow-y: auto;
            padding: 18px;
            border: 1px solid var(--border);
            background: var(--box-bg);
            border-radius: 6px;
        }

        /* ===== VIDEO ===== */
        video {
            width: 100%;
            max-height: 450px;
            border-radius: 6px;
        }

        /* ===== DOCUMENT PREVIEW ===== */
        .pdf-preview-container {
            width: 100%;
            height: 600px;
            border-radius: 6px;
            background: #fff;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .pdf-preview-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .pdf-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: #f8f9fa;
            color: #666;
        }

        .pdf-placeholder i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #3366cc;
        }

        /* ===== PROGRESS BAR ===== */
        .progress-container {
            width: 100%;
            height: 5px;
            background-color: #e0e0e0;
            border-radius: 3px;
            margin: 10px 0;
            overflow: hidden;
            display: none;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: var(--primary);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* ===== BUTTONS ===== */
        .download-btn {
            display: inline-block;
            width: fit-content;
            padding: 10px 18px;
            background: var(--primary);
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
            font-size: 15px;
            transition: background 0.3s ease, transform 0.2s ease;
            text-align: center;
            border: none;
            cursor: pointer;
            position: relative;
        }

        .download-btn:hover {
            background: #254b9b;
            transform: scale(1.05);
        }

        .download-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Container for button to ensure proper alignment */
        .btn-container {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            gap: 15px;
        }

        .btn-text {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        footer {
            margin-top: 50px;
            font-size: 14px;
            text-align: center;
            color: #54595d;
        }

        /* ===== RESPONSIVE (Mobile) ===== */
        @media (max-width: 768px) {
            .container {
                padding: 18px;
            }

            h1 {
                font-size: 1.6rem;
            }

            .pdf-preview-container {
                height: 420px;
                /* smaller but usable */
            }

            .summary-box {
                max-height: 260px;
            }
            
            .download-btn {
                width: 100%;
                text-align: center;
            }
            
            .btn-container {
                justify-content: center;
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .pdf-preview-container {
                height: 340px;
            }

            .download-btn {
                width: 100%;
            }
        }
    </style>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <div class="container">
        <!-- ===== HEADER ===== -->
        <h1>IoT-Based Air Quality Monitoring System</h1>
        <p><b>Internship:</b> GSFC University (In-House) <br> <b>Duration:</b> 01-12-2025 to 31-12-2025 <br>
            <b>Project Lead:</b> Aryan Singh
        </p>
        <!-- ===== SUMMARY ===== -->
        <h2>Project Summary</h2>
        <div class="summary-box">
            <p> Indoor air quality plays a crucial role in human health, productivity, and comfort, especially in
                enclosed environments such as classrooms, laboratories, and offices. Pollutants like carbon dioxide,
                harmful gases, and excess humidity often remain unnoticed due to their invisible nature. </p>
            <p> This project focuses on the design and development of an IoT-Based Air Quality Monitoring System that
                provides continuous real-time monitoring of environmental parameters. The system uses an ESP32
                microcontroller integrated with MQ135 gas and DHT11 temperature and humidity sensors. </p>
            <p> Sensor data is transmitted wirelessly using Wi-Fi and visualized through a cloud-based dashboard,
                enabling users to monitor air quality remotely. The system demonstrates how affordable hardware and
                open-source technologies can be combined to create a scalable and cost-effective environmental
                monitoring solution. </p>
            <p> Testing revealed that air quality varies significantly with occupancy, ventilation, and surrounding
                activities. The system enables proactive decision-making such as improving ventilation or reducing
                occupancy when air quality degrades. </p>
        </div>
        <!-- ===== VIDEO SECTION ===== -->
        <h2>Project Demonstration Video</h2>
        <div class="media-box video-section">
            <video controls>
                <source src="assets/AI_Video.mp4" type="video/mp4">
                Your browser does not support the video tag.
            </video>
            <div class="btn-container">
                <div class="progress-container" id="videoProgress">
                    <div class="progress-bar" id="videoProgressBar"></div>
                </div>
                <button class="download-btn" onclick="downloadFile('assets/AI_Video.mp4', 'AI_Video.mp4', 'videoProgress', 'videoProgressBar')">
                    <span class="btn-text">
                        <i class="fas fa-download"></i>
                        Download Video
                    </span>
                </button>
            </div>
        </div>
        <!-- ===== DOCUMENT SECTION ===== -->
        <h2>Project Report (View Only)</h2>
        <div class="media-box document-section" id="docBox">
            <!-- PDF Preview Container -->
            <div class="pdf-preview-container" id="pdfContainer">
                <!-- PDF will be loaded here -->
                <div class="pdf-placeholder" id="pdfPlaceholder">
                    <i class="fas fa-file-pdf"></i>
                    <p>Loading PDF preview...</p>
                </div>
                <!-- PDF will be embedded here -->
                <iframe id="pdfViewer" style="display: none;"></iframe>
            </div>
            
            <div class="btn-container">
                <div class="progress-container" id="pdfProgress">
                    <div class="progress-bar" id="pdfProgressBar"></div>
                </div>
                <button class="download-btn" onclick="downloadFile('assets/AirQuality_Report_NP.pdf', 'AirQuality_Report_NP.pdf', 'pdfProgress', 'pdfProgressBar')">
                    <span class="btn-text">
                        <i class="fas fa-download"></i>
                        Download Report
                    </span>
                </button>
            </div>
        </div>
        <!-- ===== FOOTER ===== -->
        <footer> Â© 2025 | IoT Internship Project | GSFC University </footer>
    </div>
    <!-- ===== SCRIPT (JS) ===== -->
    <script>
        // Function to load PDF preview
        function loadPDFPreview() {
            const pdfUrl = 'assets/AirQuality_Report_NP.pdf';
            const pdfViewer = document.getElementById('pdfViewer');
            const pdfPlaceholder = document.getElementById('pdfPlaceholder');
            
            // Try to load PDF in iframe
            pdfViewer.src = pdfUrl + '#view=FitH&toolbar=0&navpanes=0';
            pdfViewer.style.display = 'block';
            pdfPlaceholder.style.display = 'none';
            
            // If PDF fails to load, show message
            pdfViewer.onerror = function() {
                pdfViewer.style.display = 'none';
                pdfPlaceholder.style.display = 'flex';
                pdfPlaceholder.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <p>PDF preview not available. Please download the report.</p>
                `;
            };
            
            // Check if browser supports PDF viewing
            const isPdfSupported = pdfViewer.contentDocument || pdfViewer.contentWindow;
            if (!isPdfSupported) {
                pdfViewer.style.display = 'none';
                pdfPlaceholder.innerHTML = `
                    <i class="fas fa-exclamation-circle"></i>
                    <p>Your browser doesn't support PDF preview. Please download the report.</p>
                `;
                pdfPlaceholder.style.display = 'flex';
            }
        }

        // Function to download files with progress bar
        async function downloadFile(filePath, fileName, progressContainerId, progressBarId) {
            const progressContainer = document.getElementById(progressContainerId);
            const progressBar = document.getElementById(progressBarId);
            const downloadBtn = event.currentTarget;
            const originalText = downloadBtn.innerHTML;
            
            try {
                // Show progress bar
                progressContainer.style.display = 'block';
                progressBar.style.width = '0%';
                downloadBtn.disabled = true;
                downloadBtn.innerHTML = `
                    <span class="btn-text">
                        <i class="fas fa-spinner fa-spin"></i>
                        Downloading...
                    </span>
                `;
                
                // Fetch the file
                const response = await fetch(filePath);
                const contentLength = response.headers.get('content-length');
                const total = parseInt(contentLength, 10);
                
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                
                // Read the response as a stream
                const reader = response.body.getReader();
                let receivedLength = 0;
                const chunks = [];
                
                while(true) {
                    const {done, value} = await reader.read();
                    
                    if (done) {
                        break;
                    }
                    
                    chunks.push(value);
                    receivedLength += value.length;
                    
                    // Update progress bar
                    if (total) {
                        const percentComplete = (receivedLength / total) * 100;
                        progressBar.style.width = percentComplete + '%';
                    }
                }
                
                // Combine chunks
                const blob = new Blob(chunks);
                const url = window.URL.createObjectURL(blob);
                
                // Create download link
                const a = document.createElement('a');
                a.href = url;
                a.download = fileName;
                document.body.appendChild(a);
                a.click();
                
                // Cleanup
                a.remove();
                window.URL.revokeObjectURL(url);
                
                // Reset UI
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                    progressBar.style.width = '0%';
                    downloadBtn.disabled = false;
                    downloadBtn.innerHTML = originalText;
                    
                    // Show success message
                    alert('Download completed successfully!');
                }, 500);
                
            } catch (error) {
                console.error('Download error:', error);
                
                // Reset UI
                progressContainer.style.display = 'none';
                progressBar.style.width = '0%';
                downloadBtn.disabled = false;
                downloadBtn.innerHTML = originalText;
                
                // Show error message
                alert('Download failed. Please try again or check the file path.');
            }
        }

        // Disable right click
        document.addEventListener("contextmenu", function (e) {
            e.preventDefault();
        });

        // Disable text selection
        document.addEventListener("selectstart", function (e) {
            e.preventDefault();
        });

        // Disable copy shortcuts
        document.addEventListener("keydown", function (e) {
            if (e.ctrlKey && (e.key === "c" || e.key === "u" || e.key === "s")) {
                e.preventDefault();
            }
        });

        // Load PDF preview when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Load PDF preview
            loadPDFPreview();
            
            // Try alternative method for PDF preview if iframe fails
            setTimeout(() => {
                const pdfViewer = document.getElementById('pdfViewer');
                const pdfPlaceholder = document.getElementById('pdfPlaceholder');
                
                if (pdfViewer.style.display === 'none') {
                    // Try using Google Docs Viewer as fallback
                    const pdfUrl = 'assets/AirQuality_Report_NP.pdf';
                    pdfViewer.src = 'https://docs.google.com/gview?url=' + encodeURIComponent(window.location.origin + '/' + pdfUrl) + '&embedded=true';
                    pdfViewer.style.display = 'block';
                    pdfPlaceholder.style.display = 'none';
                    
                    pdfViewer.onerror = function() {
                        pdfViewer.style.display = 'none';
                        pdfPlaceholder.style.display = 'flex';
                        pdfPlaceholder.innerHTML = `
                            <i class="fas fa-exclamation-triangle"></i>
                            <p>PDF preview requires download. Click the button below.</p>
                        `;
                    };
                }
            }, 2000);
        });

    </script>
</body>

</html>
